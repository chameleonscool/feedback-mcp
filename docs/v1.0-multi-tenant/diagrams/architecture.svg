<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 850">
  <defs>
    <linearGradient id="headerGrad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#3b82f6"/>
      <stop offset="100%" style="stop-color:#8b5cf6"/>
    </linearGradient>
    <linearGradient id="clientGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#dbeafe"/>
      <stop offset="100%" style="stop-color:#bfdbfe"/>
    </linearGradient>
    <linearGradient id="serverGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#dcfce7"/>
      <stop offset="100%" style="stop-color:#bbf7d0"/>
    </linearGradient>
    <linearGradient id="dataGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#fef3c7"/>
      <stop offset="100%" style="stop-color:#fde68a"/>
    </linearGradient>
    <linearGradient id="externalGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#fce7f3"/>
      <stop offset="100%" style="stop-color:#fbcfe8"/>
    </linearGradient>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="2" dy="2" stdDeviation="3" flood-opacity="0.15"/>
    </filter>
  </defs>
  
  <!-- Title -->
  <rect x="0" y="0" width="1000" height="50" fill="url(#headerGrad)"/>
  <text x="500" y="32" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="20" font-weight="bold">
    é£ä¹¦å¤šç§Ÿæˆ·ç³»ç»Ÿæ¶æ„å›¾
  </text>
  
  <!-- Client Layer -->
  <rect x="20" y="70" width="960" height="140" rx="10" fill="url(#clientGrad)" filter="url(#shadow)"/>
  <text x="40" y="95" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#1e40af">å®¢æˆ·ç«¯å±‚ (Client Layer)</text>
  
  <!-- MCP Client -->
  <rect x="60" y="110" width="180" height="80" rx="8" fill="white" stroke="#3b82f6" stroke-width="2"/>
  <text x="150" y="140" text-anchor="middle" font-family="Arial, sans-serif" font-size="13" font-weight="bold" fill="#1e40af">ğŸ¤– MCP å®¢æˆ·ç«¯</text>
  <text x="150" y="160" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#64748b">Cursor / Claude</text>
  <text x="150" y="178" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#94a3b8">stdio / SSE</text>
  
  <!-- Web UI -->
  <rect x="280" y="110" width="180" height="80" rx="8" fill="white" stroke="#3b82f6" stroke-width="2"/>
  <text x="370" y="140" text-anchor="middle" font-family="Arial, sans-serif" font-size="13" font-weight="bold" fill="#1e40af">ğŸŒ Web UI</text>
  <text x="370" y="160" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#64748b">æµè§ˆå™¨</text>
  <text x="370" y="178" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#94a3b8">HTTP / Polling</text>
  
  <!-- Feishu App -->
  <rect x="500" y="110" width="180" height="80" rx="8" fill="white" stroke="#3b82f6" stroke-width="2"/>
  <text x="590" y="140" text-anchor="middle" font-family="Arial, sans-serif" font-size="13" font-weight="bold" fill="#1e40af">ğŸ“± é£ä¹¦ App</text>
  <text x="590" y="160" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#64748b">ç§»åŠ¨ç«¯ / æ¡Œé¢ç«¯</text>
  <text x="590" y="178" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#94a3b8">é£ä¹¦æ¶ˆæ¯</text>
  
  <!-- Admin UI -->
  <rect x="720" y="110" width="180" height="80" rx="8" fill="white" stroke="#3b82f6" stroke-width="2"/>
  <text x="810" y="140" text-anchor="middle" font-family="Arial, sans-serif" font-size="13" font-weight="bold" fill="#1e40af">âš™ï¸ ç®¡ç†åå°</text>
  <text x="810" y="160" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#64748b">Admin Panel</text>
  <text x="810" y="178" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#94a3b8">HTTP</text>
  
  <!-- Arrows from Client to Server -->
  <line x1="150" y1="190" x2="150" y2="235" stroke="#64748b" stroke-width="2"/>
  <polygon points="145,235 155,235 150,245" fill="#64748b"/>
  
  <line x1="370" y1="190" x2="370" y2="235" stroke="#64748b" stroke-width="2"/>
  <polygon points="365,235 375,235 370,245" fill="#64748b"/>
  
  <line x1="590" y1="190" x2="590" y2="235" stroke="#64748b" stroke-width="2"/>
  <polygon points="585,235 595,235 590,245" fill="#64748b"/>
  
  <line x1="810" y1="190" x2="810" y2="235" stroke="#64748b" stroke-width="2"/>
  <polygon points="805,235 815,235 810,245" fill="#64748b"/>
  
  <!-- Server Layer -->
  <rect x="20" y="250" width="960" height="280" rx="10" fill="url(#serverGrad)" filter="url(#shadow)"/>
  <text x="40" y="275" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#166534">æœåŠ¡å±‚ (Server Layer) - å•ä¸€å…¥å£å¯åŠ¨</text>
  
  <!-- Main Process Box -->
  <rect x="50" y="290" width="580" height="220" rx="8" fill="white" stroke="#22c55e" stroke-width="2"/>
  <text x="70" y="315" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#166534">ä¸»è¿›ç¨‹ - FastAPI/Uvicorn (web_multi_tenant.py)</text>
  
  <!-- API Layer -->
  <rect x="70" y="330" width="130" height="55" rx="6" fill="#f0fdf4" stroke="#22c55e" stroke-width="1.5"/>
  <text x="135" y="355" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#166534">MCP æœåŠ¡</text>
  <text x="135" y="372" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#64748b">core.py</text>
  
  <rect x="215" y="330" width="130" height="55" rx="6" fill="#f0fdf4" stroke="#22c55e" stroke-width="1.5"/>
  <text x="280" y="355" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#166534">Web API</text>
  <text x="280" y="372" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#64748b">web_multi_tenant.py</text>
  
  <rect x="360" y="330" width="130" height="55" rx="6" fill="#f0fdf4" stroke="#22c55e" stroke-width="1.5"/>
  <text x="425" y="355" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#166534">Auth/OAuth</text>
  <text x="425" y="372" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#64748b">auth.py / oauth.py</text>
  
  <rect x="505" y="330" width="110" height="55" rx="6" fill="#f0fdf4" stroke="#22c55e" stroke-width="1.5"/>
  <text x="560" y="355" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#166534">ç”¨æˆ·ç®¡ç†</text>
  <text x="560" y="372" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#64748b">users.py</text>
  
  <!-- Business Logic Layer -->
  <rect x="140" y="400" width="180" height="45" rx="6" fill="#dcfce7" stroke="#16a34a" stroke-width="1.5"/>
  <text x="230" y="422" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#166534">é£ä¹¦æ¶ˆæ¯å‘é€</text>
  <text x="230" y="437" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#64748b">feishu.py</text>
  
  <rect x="340" y="400" width="180" height="45" rx="6" fill="#dcfce7" stroke="#16a34a" stroke-width="1.5"/>
  <text x="430" y="422" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#166534">æ¶ˆæ¯è·¯ç”±</text>
  <text x="430" y="437" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#64748b">routing.py</text>
  
  <!-- Status -->
  <rect x="70" y="460" width="540" height="35" rx="4" fill="#f0fdf4" stroke="#86efac" stroke-width="1"/>
  <text x="90" y="482" font-family="Arial, sans-serif" font-size="10" fill="#166534">ğŸ“Š çŠ¶æ€: HTTP API + é…ç½®ç›‘æ§ + å­è¿›ç¨‹ç®¡ç†</text>
  
  <!-- WebSocket Subprocess Box -->
  <rect x="660" y="290" width="300" height="220" rx="8" fill="white" stroke="#ec4899" stroke-width="2"/>
  <text x="680" y="315" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#9d174d">å­è¿›ç¨‹ - WebSocket ç›‘å¬å™¨</text>
  <text x="680" y="332" font-family="Arial, sans-serif" font-size="10" fill="#64748b">(feishu_ws_listener.py)</text>
  
  <rect x="680" y="350" width="260" height="70" rx="6" fill="#fce7f3" stroke="#ec4899" stroke-width="1.5"/>
  <text x="810" y="375" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#9d174d">FeishuWSListener</text>
  <text x="810" y="395" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#64748b">WebSocket é•¿è¿æ¥</text>
  <text x="810" y="410" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#be185d">æ¥æ”¶é£ä¹¦æ¶ˆæ¯å›å¤</text>
  
  <rect x="680" y="435" width="260" height="55" rx="6" fill="#fdf2f8" stroke="#f9a8d4" stroke-width="1"/>
  <text x="810" y="458" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#9d174d">FeishuWSManager</text>
  <text x="810" y="475" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#64748b">è¿›ç¨‹ç®¡ç† | è‡ªåŠ¨é‡å¯ | é…ç½®æ›´æ–°</text>
  
  <!-- Arrow between processes -->
  <line x1="630" y1="400" x2="670" y2="400" stroke="#64748b" stroke-width="2" stroke-dasharray="4,4"/>
  <polygon points="670,395 680,400 670,405" fill="#64748b"/>
  <text x="650" y="390" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#64748b">å¯åŠ¨</text>
  
  <!-- Arrow from Server to Data Layer -->
  <line x1="400" y1="495" x2="400" y2="540" stroke="#64748b" stroke-width="1.5" stroke-dasharray="4,4"/>
  <polygon points="395,540 405,540 400,550" fill="#64748b"/>
  
  <line x1="810" y1="510" x2="810" y2="540" stroke="#64748b" stroke-width="1.5" stroke-dasharray="4,4"/>
  <polygon points="805,540 815,540 810,550" fill="#64748b"/>
  
  <!-- Data Layer -->
  <rect x="20" y="550" width="960" height="120" rx="10" fill="url(#dataGrad)" filter="url(#shadow)"/>
  <text x="40" y="575" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#92400e">æ•°æ®å±‚ (Data Layer)</text>
  
  <!-- SQLite -->
  <rect x="60" y="590" width="900" height="60" rx="8" fill="white" stroke="#f59e0b" stroke-width="2"/>
  <text x="110" y="615" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#92400e">SQLite Database</text>
  
  <rect x="200" y="598" width="100" height="35" rx="4" fill="#fef3c7" stroke="#d97706" stroke-width="1"/>
  <text x="250" y="620" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#92400e">admin_config</text>
  
  <rect x="310" y="598" width="110" height="35" rx="4" fill="#fef3c7" stroke="#d97706" stroke-width="1"/>
  <text x="365" y="620" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#92400e">admin_sessions</text>
  
  <rect x="430" y="598" width="80" height="35" rx="4" fill="#fef3c7" stroke="#d97706" stroke-width="1"/>
  <text x="470" y="620" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#92400e">users</text>
  
  <rect x="520" y="598" width="100" height="35" rx="4" fill="#fef3c7" stroke="#d97706" stroke-width="1"/>
  <text x="570" y="620" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#92400e">user_settings</text>
  
  <rect x="630" y="598" width="100" height="35" rx="4" fill="#fef3c7" stroke="#d97706" stroke-width="1"/>
  <text x="680" y="620" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#92400e">intent_queue</text>
  
  <!-- External Services -->
  <rect x="20" y="690" width="960" height="140" rx="10" fill="url(#externalGrad)" filter="url(#shadow)"/>
  <text x="40" y="715" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#9d174d">å¤–éƒ¨æœåŠ¡ (External Services)</text>
  
  <!-- Feishu Open Platform -->
  <rect x="100" y="735" width="350" height="75" rx="8" fill="white" stroke="#ec4899" stroke-width="2"/>
  <text x="275" y="760" text-anchor="middle" font-family="Arial, sans-serif" font-size="13" font-weight="bold" fill="#9d174d">ğŸ” é£ä¹¦å¼€æ”¾å¹³å°</text>
  <text x="275" y="780" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#64748b">OAuth è®¤è¯ | ç”¨æˆ·ä¿¡æ¯ API</text>
  <text x="275" y="795" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#64748b">Token ç®¡ç†</text>
  
  <!-- Feishu IM -->
  <rect x="500" y="735" width="350" height="75" rx="8" fill="white" stroke="#ec4899" stroke-width="2"/>
  <text x="675" y="760" text-anchor="middle" font-family="Arial, sans-serif" font-size="13" font-weight="bold" fill="#9d174d">ğŸ’¬ é£ä¹¦ IM</text>
  <text x="675" y="780" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#64748b">å‘é€æ¶ˆæ¯ API (HTTP)</text>
  <text x="675" y="795" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#64748b">WebSocket é•¿è¿æ¥ (æ¥æ”¶æ¶ˆæ¯)</text>
  
  <!-- Connection lines -->
  <line x1="275" y1="670" x2="275" y2="735" stroke="#ec4899" stroke-width="1.5" stroke-dasharray="4,4"/>
  <line x1="675" y1="670" x2="675" y2="735" stroke="#ec4899" stroke-width="1.5" stroke-dasharray="4,4"/>
  <line x1="810" y1="510" x2="810" y2="530" stroke="#ec4899" stroke-width="1.5" stroke-dasharray="4,4"/>
  <line x1="810" y1="530" x2="850" y2="530" stroke="#ec4899" stroke-width="1.5" stroke-dasharray="4,4"/>
  <line x1="850" y1="530" x2="850" y2="680" stroke="#ec4899" stroke-width="1.5" stroke-dasharray="4,4"/>
  <line x1="850" y1="680" x2="675" y2="680" stroke="#ec4899" stroke-width="1.5" stroke-dasharray="4,4"/>
  <line x1="675" y1="680" x2="675" y2="735" stroke="#ec4899" stroke-width="1.5" stroke-dasharray="4,4"/>
</svg>
